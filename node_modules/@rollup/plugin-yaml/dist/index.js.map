{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import YAML from 'js-yaml';\nimport toSource from 'tosource';\nimport { createFilter, makeLegalIdentifier } from '@rollup/pluginutils';\n\nconst defaults = {\n  documentMode: 'single',\n  safe: true,\n  transform: null\n};\nconst ext = /\\.ya?ml$/;\n\nexport default function yaml(opts = {}) {\n  const options = Object.assign({}, defaults, opts);\n  const { documentMode, safe } = options;\n  const filter = createFilter(options.include, options.exclude);\n  let loadMethod = null;\n\n  if (documentMode === 'single') {\n    loadMethod = safe ? YAML.load : YAML.safeLoad;\n  } else if (documentMode === 'multi') {\n    loadMethod = safe ? YAML.loadAll : YAML.safeLoadAll;\n  } else {\n    this.error(\n      `plugin-yaml â†’ documentMode: '${documentMode}' is not a valid value. Please choose 'single' or 'multi'`\n    );\n  }\n\n  return {\n    name: 'yaml',\n\n    transform(content, id) {\n      if (!ext.test(id)) return null;\n      if (!filter(id)) return null;\n\n      let data = loadMethod(content);\n\n      if (typeof options.transform === 'function') {\n        const result = options.transform(data, id);\n        // eslint-disable-next-line no-undefined\n        if (result !== undefined) {\n          data = result;\n        }\n      }\n\n      const keys = Object.keys(data).filter((key) => key === makeLegalIdentifier(key));\n      const code = `var data = ${toSource(data)};\\n\\n`;\n      const exports = ['export default data;']\n        .concat(keys.map((key) => `export var ${key} = data.${key};`))\n        .join('\\n');\n\n      return {\n        code: code + exports,\n        map: { mappings: '' }\n      };\n    }\n  };\n}\n"],"names":["createFilter","YAML","makeLegalIdentifier","toSource"],"mappings":";;;;;;;;;;;AAIA,MAAM,QAAQ,GAAG;AACjB,EAAE,YAAY,EAAE,QAAQ;AACxB,EAAE,IAAI,EAAE,IAAI;AACZ,EAAE,SAAS,EAAE,IAAI;AACjB,CAAC,CAAC;AACF,MAAM,GAAG,GAAG,UAAU,CAAC;AACvB;AACe,SAAS,IAAI,CAAC,IAAI,GAAG,EAAE,EAAE;AACxC,EAAE,MAAM,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;AACpD,EAAE,MAAM,EAAE,YAAY,EAAE,IAAI,EAAE,GAAG,OAAO,CAAC;AACzC,EAAE,MAAM,MAAM,GAAGA,wBAAY,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;AAChE,EAAE,IAAI,UAAU,GAAG,IAAI,CAAC;AACxB;AACA,EAAE,IAAI,YAAY,KAAK,QAAQ,EAAE;AACjC,IAAI,UAAU,GAAG,IAAI,GAAGC,wBAAI,CAAC,IAAI,GAAGA,wBAAI,CAAC,QAAQ,CAAC;AAClD,GAAG,MAAM,IAAI,YAAY,KAAK,OAAO,EAAE;AACvC,IAAI,UAAU,GAAG,IAAI,GAAGA,wBAAI,CAAC,OAAO,GAAGA,wBAAI,CAAC,WAAW,CAAC;AACxD,GAAG,MAAM;AACT,IAAI,IAAI,CAAC,KAAK;AACd,MAAM,CAAC,6BAA6B,EAAE,YAAY,CAAC,yDAAyD,CAAC;AAC7G,KAAK,CAAC;AACN,GAAG;AACH;AACA,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,MAAM;AAChB;AACA,IAAI,SAAS,CAAC,OAAO,EAAE,EAAE,EAAE;AAC3B,MAAM,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,OAAO,IAAI,CAAC;AACrC,MAAM,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,OAAO,IAAI,CAAC;AACnC;AACA,MAAM,IAAI,IAAI,GAAG,UAAU,CAAC,OAAO,CAAC,CAAC;AACrC;AACA,MAAM,IAAI,OAAO,OAAO,CAAC,SAAS,KAAK,UAAU,EAAE;AACnD,QAAQ,MAAM,MAAM,GAAG,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;AACnD;AACA,QAAQ,IAAI,MAAM,KAAK,SAAS,EAAE;AAClC,UAAU,IAAI,GAAG,MAAM,CAAC;AACxB,SAAS;AACT,OAAO;AACP;AACA,MAAM,MAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,GAAG,KAAK,GAAG,KAAKC,+BAAmB,CAAC,GAAG,CAAC,CAAC,CAAC;AACvF,MAAM,MAAM,IAAI,GAAG,CAAC,WAAW,EAAEC,4BAAQ,CAAC,IAAI,CAAC,CAAC,KAAK,CAAC,CAAC;AACvD,MAAM,MAAM,OAAO,GAAG,CAAC,sBAAsB,CAAC;AAC9C,SAAS,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,KAAK,CAAC,WAAW,EAAE,GAAG,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;AACtE,SAAS,IAAI,CAAC,IAAI,CAAC,CAAC;AACpB;AACA,MAAM,OAAO;AACb,QAAQ,IAAI,EAAE,IAAI,GAAG,OAAO;AAC5B,QAAQ,GAAG,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE;AAC7B,OAAO,CAAC;AACR,KAAK;AACL,GAAG,CAAC;AACJ;;;;"}